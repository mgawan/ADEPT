cmake_minimum_required(VERSION 3.8 FATAL_ERROR)
project(adept LANGUAGES CUDA)
set(CMAKE_CUDA_STANDARD 11)
#set(CMAKE_CXX_STANDARD_REQUIRED TRUE)

set(CMAKE_POSITION_INDEPENDENT_CODE ON)
set(CMAKE_CUDA_SEPARABLE_COMPILATION ON)
file(GLOB SOURCE_FILES *.cpp)
set(HEADER_FILES "*kernel.hpp driver.hpp")
enable_language(CUDA)
#set(CMAKE_CUDA_FLAGS "${CMAKE_CUDA_FLAGS} -Xcompiler")
set_source_files_properties(${SOURCE_FILES} PROPERTIES LANGUAGE CUDA LINKER_LANGUAGE CUDA)

add_library(adept_obj OBJECT ${SOURCE_FILES})
add_library(adept_lib_shared SHARED $<TARGET_OBJECTS:adept_obj>)
install(TARGETS adept_lib_shared LIBRARY DESTINATION lib)


# add_library(ADEPT_SW_LIBRARY_shared SHARED $<TARGET_OBJECTS:ADEPT_SW_LIBRARY_obj>)
# set_property(TARGET ADEPT_SW_LIBRARY_shared PROPERTY CUDA_RESOLVE_DEVICE_SYMBOLS ON)
# target_link_libraries(ADEPT_SW_LIBRARY_shared INTERFACE OpenMP::OpenMP_CXX) 
# install(TARGETS ADEPT_SW_LIBRARY_shared LIBRARY DESTINATION lib)

# set(CMAKE_CUDA_STANDARD 11 CACHE STRING "")
# set(CMAKE_CUDA_STANDARD_REQUIRED ON CACHE BOOL "")
# set(CMAKE_CUDA_EXTENSIONS OFF CACHE BOOL "")
